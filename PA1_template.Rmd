---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

## Loading and preprocessing the data

Unzip data and loading into "activity" variable. Review structure of data.
```{r data, echo=TRUE}
unzip("activity.zip")
activity <- read.csv("activity.csv",header=TRUE,sep=",")
head(activity)
summary(activity)
str(activity)
```

## What is mean total number of steps taken per day?

For this part of the assignment, we ignore the missing values in the dataset.  
Calculate the total number of steps taken per day
```{r steps, echo=TRUE}
Total_steps <- aggregate(steps ~ date, activity, sum, na.rm=TRUE)
```
Histogram of the total number of steps taken each day   
```{r hist, echo=TRUE}
hist(Total_steps$steps,col="blue",main="Steps taken per Day", xlab="Days",ylab = "Steps")
```
Mean and median number of steps taken each day  

```{r mm, echo=TRUE}
Mean_steps <- mean(Total_steps$steps)
print(Mean_steps)
Median_steps <- median(Total_steps$steps)
print(Median_steps)
```

## What is the average daily activity pattern?

Time series plot of the average number of steps taken  
```{r average, echo=TRUE}
Avg_Steps <- aggregate(steps ~ interval, activity, sum)
plot(Avg_Steps$interval,Avg_Steps$steps,col="red",type="l",main="Average number of steps taken",xlab="Interval", ylab="Steps")
```
The 5-minute interval that, on average, contains the maximum number of steps
```{r minute, echo=TRUE}
Avg_Steps[which.max(Avg_Steps$steps),1]
```

## Imputing missing values
Code to describe and show a strategy for imputing missing data
```{r missing, echo=TRUE}
mv_steps <- sum(is.na(activity$steps))
print(mv_steps)
```
Strategy for filling in all of the missing values in the dataset: Replacing missing values (NA) with the Average of number of Steps

```{r strategy, echo=TRUE}
new_steps <- Avg_Steps[which.max(Avg_Steps$steps),1]
activity$steps <- ifelse(is.na(activity$steps),new_steps,activity$steps)
sum(is.na(activity$steps))
```
Create a new dataset that is equal to the original dataset but with the missing data filled in.
```{r newds, echo=TRUE}
NewDS <- activity
head(NewDS)
```
Histogram of the total number of steps taken each day after missing values are imputed
```{r newhist, echo=TRUE}
NewT_steps <- aggregate(steps ~ date, NewDS, sum)
hist(log10(NewT_steps$steps),col="blue",main="Steps taken per Day", xlab="Days",ylab = "Steps")
```
## Are there differences in activity patterns between weekdays and weekends?
